<div class="dashboard-container">
    <h2>Tu Panel de Referidos</h2>

    <div *ngIf="isLoading" class="loading">
        <i class="bi bi-arrow-repeat"></i> Cargando estadísticas...
    </div>

    <div *ngIf="!isLoading && !hasError" class="stats-grid">
        <!-- Tarjeta de Total Referidos -->
        <div class="stat-card">
            <div class="stat-icon">
                <i class="bi bi-people-fill"></i>
            </div>
            <h3>Total Referidos</h3>
            <p class="stat-value">{{ stats.totalReferrals }}</p>
            <p class="stat-description">Personas que usaron tu enlace</p>
        </div>

        <!-- Tarjeta de Referidos Activos -->
        <div class="stat-card">
            <div class="stat-icon">
                <i class="bi bi-person-check-fill"></i>
            </div>
            <h3>Referidos Activos</h3>
            <p class="stat-value">{{ stats.activeReferrals }}</p>
            <p class="stat-description">Cuentas activas</p>
        </div>

        <!-- Tarjeta de Tasa de Conversión -->
        <div class="stat-card">
            <div class="stat-icon">
                <i class="bi bi-graph-up-arrow"></i>
            </div>
            <h3>Tasa de Conversión</h3>
            <p class="stat-value">{{ stats.conversionRate }}%</p>
            <p class="stat-description">Efectividad de tus referidos</p>
        </div>
    </div>

    <!-- Sección de Referidos Recientes -->
    <div class="recent-referrals" *ngIf="!isLoading && !hasError && (stats.recentReferrals?.length ?? 0) > 0">
        <h3>Referidos Recientes</h3>
        <div class="referrals-list">
            <div class="referral-item" *ngFor="let ref of stats.recentReferrals">
                <div class="referral-avatar">
                    <i class="bi bi-person-circle"></i>
                </div>
                <div class="referral-info">
                    <p class="referral-name">{{ ref.name || 'Usuario anónimo' }}</p>
                    <p class="referral-email">{{ ref.email || 'Correo no disponible' }}</p>
                    <p class="referral-date">{{ (ref.date | date:'mediumDate') || 'Fecha no disponible' }}</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Mensaje cuando no hay referidos -->
    <div *ngIf="!isLoading && !hasError && stats.totalReferrals === 0" class="no-referrals">
        <i class="bi bi-emoji-frown"></i>
        <p>Aún no tienes referidos. ¡Comparte tu enlace para comenzar!</p>
    </div>

    <!-- Mensaje de error -->
    <div *ngIf="!isLoading && hasError !== undefined && hasError" class="error-message">
        <i class="bi bi-exclamation-triangle"></i>
        <p>No se pudieron cargar las estadísticas. Por favor intenta más tarde.</p>
    </div>
</div>